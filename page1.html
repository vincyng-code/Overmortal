<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ–éˆè‡ºå‡ç´šè¨ˆç®—å™¨</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        body {
            background-color: #f5f0e6;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #d4b483;
            background-color: #fff;
            border-radius: 15px 15px 0 0;
            padding: 30px 20px 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        h1 {
            color: #8b4513;
            margin-top: 0;
            font-size: 2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .subtitle {
            color: #a0522d;
            font-size: 1rem;
            margin-top: 5px;
        }
        
        .breakthrough-info {
            background-color: #f9f5eb;
            padding: 20px;
            border-radius: 10px;
            margin: 25px auto;
            max-width: 800px;
            border: 1px solid #e0d6c2;
        }
        
        .breakthrough-title {
            color: #8b4513;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .breakthrough-title:before {
            content: "â°";
            margin-right: 10px;
        }
        
        .breakthrough-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 600px) {
            .breakthrough-inputs {
                grid-template-columns: 1fr;
            }
        }
        
        .countdown-display {
            background-color: #8b4513;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.4rem;
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
        }
        
        .countdown-value {
            font-size: 1.8rem;
            margin: 10px 0;
            color: #ffd700;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section, .results-section {
            background-color: #fff;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #e0d6c2;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: #8b4513;
            border-bottom: 1px solid #d4b483;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
        }
        
        .section-title:before {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .input-section .section-title:before {
            content: "ğŸ“Š";
        }
        
        .results-section .section-title:before {
            content: "ğŸ“ˆ";
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #5d4037;
        }
        
        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #c9b8a4;
            border-radius: 8px;
            font-size: 1rem;
            background-color: #fff;
            transition: border-color 0.3s;
        }
        
        select:focus, input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #8b4513;
            box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.1);
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 600px) {
            .input-row {
                grid-template-columns: 1fr;
            }
        }
        
        .time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 500px) {
            .time-inputs {
                grid-template-columns: 1fr;
            }
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        @media (max-width: 500px) {
            .button-group {
                flex-direction: column;
            }
        }
        
        button {
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        #calculateBtn {
            background-color: #8b4513;
            color: white;
        }
        
        #calculateBtn:hover {
            background-color: #a0522d;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 69, 19, 0.2);
        }
        
        #resetBtn {
            background-color: #b0a18e;
            color: white;
        }
        
        #resetBtn:hover {
            background-color: #9c8e7d;
        }
        
        .result-item {
            background-color: #f9f5eb;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 5px solid #8b4513;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .result-title {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #5d4037;
            margin: 10px 0;
            word-break: break-word;
        }
        
        @media (max-width: 500px) {
            .result-value {
                font-size: 1.3rem;
            }
        }
        
        .highlight {
            color: #d35400;
            font-size: 1.8rem;
        }
        
        @media (max-width: 500px) {
            .highlight {
                font-size: 1.5rem;
            }
        }
        
        .warning {
            color: #c0392b;
            font-weight: bold;
        }
        
        .success {
            color: #27ae60;
            font-weight: bold;
        }
        
        .info-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .breakdown-table th, .breakdown-table td {
            padding: 10px 12px;
            text-align: center;
            border: 1px solid #e0d6c2;
            font-size: 0.9rem;
        }
        
        @media (max-width: 500px) {
            .breakdown-table th, .breakdown-table td {
                padding: 8px 6px;
                font-size: 0.85rem;
            }
        }
        
        .breakdown-table th {
            background-color: #f1e8d9;
            color: #5d4037;
            font-weight: bold;
        }
        
        .breakdown-table tr:nth-child(even) {
            background-color: #f9f5eb;
        }
        
        .advance-options {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px dashed #d4b483;
        }
        
        .advance-title {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .checkbox-container {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .checkbox-container input {
            width: auto;
            margin-right: 10px;
            min-width: 18px;
            min-height: 18px;
        }
        
        .level-selects {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 600px) {
            .level-selects {
                grid-template-columns: 1fr;
            }
        }
        
        .level-select {
            display: flex;
            flex-direction: column;
        }
        
        .note-box {
            background-color: #e8f4fd;
            border-left: 5px solid #3498db;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 0.9rem;
        }
        
        .note-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0d6c2;
            color: #777;
            font-size: 0.9rem;
            padding-bottom: 20px;
        }
        
        .compact-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .attribute-levels {
            background-color: #f9f5eb;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0d6c2;
            margin-bottom: 20px;
        }
        
        .compact-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 700px) {
            .compact-row {
                grid-template-columns: 1fr;
            }
        }
        
        .monster-select-info {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .monster-power {
            color: #8b4513;
            font-weight: bold;
        }
        
        .mobile-optimized {
            display: block;
        }
        
        .desktop-only {
            display: none;
        }
        
        @media (min-width: 768px) {
            .mobile-optimized {
                display: none;
            }
            
            .desktop-only {
                display: block;
            }
        }
        
        .data-source {
            font-size: 0.8rem;
            color: #888;
            text-align: right;
            margin-top: 5px;
        }
        
        .countdown-timer {
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .time-unit {
            display: inline-block;
            min-width: 70px;
            text-align: center;
            margin: 0 5px;
        }
        
        @media (max-width: 500px) {
            .time-unit {
                min-width: 60px;
                margin: 0 3px;
            }
        }
        
        .time-value {
            font-size: 1.8rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        @media (max-width: 500px) {
            .time-value {
                font-size: 1.5rem;
            }
        }
        
        .time-label {
            font-size: 0.8rem;
            color: #ffcc80;
            display: block;
            margin-top: 5px;
        }
        
        .monster-option {
            display: flex;
            justify-content: space-between;
        }
        
        .monster-option-name {
            font-weight: bold;
        }
        
        .monster-option-power {
            color: #8b4513;
        }
        
        .monster-option-souls {
            color: #27ae60;
            font-weight: bold;
        }
        
        .beijing-time {
            font-size: 0.9rem;
            color: #fff;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .current-time {
            color: #ffcc80;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ä¸€å¿µé€é™ - åŒ–éˆè‡ºå‡ç´šè¨ˆç®—å™¨</h1>
            <div class="subtitle">æ ¹æ“šå®˜æ–¹æ•¸æ“šè¨ˆç®—åŒ–éˆè‡ºå‡ç´šæ‰€éœ€å¦–é­„èˆ‡è¬å¦–æŒ‘æˆ°æ¬¡æ•¸</div>
        </header>
        
        <div class="breakthrough-info">
            <div class="breakthrough-title">çªç ´æ™‚é–“è¨­å®š (åŒ—äº¬æ™‚é–“)</div>
            <div class="breakthrough-inputs">
                <div class="form-group">
                    <label for="daysToBreakthrough">å¤©æ•¸ï¼š</label>
                    <input type="number" id="daysToBreakthrough" min="0" value="0" placeholder="å¤©æ•¸">
                </div>
                <div class="form-group">
                    <label for="hoursToBreakthrough">å°æ™‚ï¼š</label>
                    <input type="number" id="hoursToBreakthrough" min="0" max="23" value="0" placeholder="å°æ™‚">
                </div>
                <div class="form-group">
                    <label for="minutesToBreakthrough">åˆ†é˜ï¼š</label>
                    <input type="number" id="minutesToBreakthrough" min="0" max="59" value="0" placeholder="åˆ†é˜">
                </div>
            </div>
            
            <div id="countdownContainer" style="display: none;">
                <div class="countdown-display">
                    <div>è·é›¢çªç ´é‚„æœ‰</div>
                    <div class="countdown-timer">
                        <span class="time-unit">
                            <span id="countdownDays" class="time-value">0</span>
                            <span class="time-label">å¤©</span>
                        </span>
                        <span class="time-unit">
                            <span id="countdownHours" class="time-value">0</span>
                            <span class="time-label">å°æ™‚</span>
                        </span>
                        <span class="time-unit">
                            <span id="countdownMinutes" class="time-value">0</span>
                            <span class="time-label">åˆ†é˜</span>
                        </span>
                    </div>
                    <div class="beijing-time">
                        ç•¶å‰åŒ—äº¬æ™‚é–“ï¼š<span id="currentBeijingTime" class="current-time">00:00:00</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">ç•¶å‰ç‹€æ…‹è¨­å®š</h2>
                
                <div class="form-group">
                    <label for="realm">é¸æ“‡ç•¶å‰å¢ƒç•Œï¼š</label>
                    <select id="realm">
                        <option value="äººç•Œ">äººç•Œ</option>
                        <option value="è¿”è™›">è¿”è™›</option>
                        <option value="åˆé«”">åˆé«”</option>
                        <option value="å¤§æˆ">å¤§æˆ</option>
                        <option value="æ¸¡åŠ«">æ¸¡åŠ«</option>
                        <option value="çœŸä»™">çœŸä»™</option>
                        <option value="é‡‘ä»™">é‡‘ä»™</option>
                        <option value="å¤ªä¹™">å¤ªä¹™</option>
                        <option value="å¤§ç¾…">å¤§ç¾…</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <div class="attribute-levels">
                        <label>ç•¶å‰å±¬æ€§ç­‰ç´šï¼š</label>
                        <div class="compact-row">
                            <div class="level-select">
                                <label for="cultivation">ä¿®ç‚ºï¼š</label>
                                <select id="cultivation">
                                    <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                </select>
                            </div>
                            <div class="level-select">
                                <label for="quality">å“è³ªï¼š</label>
                                <select id="quality">
                                    <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                </select>
                            </div>
                            <div class="level-select">
                                <label for="spiritFlow">éˆæ¹§ï¼š</label>
                                <select id="spiritFlow">
                                    <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                </select>
                            </div>
                            <div class="level-select">
                                <label for="highQuality">é«˜å“ï¼š</label>
                                <select id="highQuality">
                                    <!-- é¸é …å°‡ç”±JavaScriptç”Ÿæˆ -->
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="monsterSelect">è¬å¦–é¦–é ˜èˆ‡å¯ç²å¦–é­„ï¼š</label>
                    <select id="monsterSelect">
                        <!-- é¸é …å°‡ç”±JavaScriptæ ¹æ“šå¢ƒç•Œç”Ÿæˆ -->
                    </select>
                    <div class="monster-select-info">
                        <span id="monsterPower">æˆ°åŠ›è¦æ±‚ï¼šç„¡</span>
                        <span id="monsterSouls">å¦–é­„ï¼š0</span>
                    </div>
                    <div class="data-source">*æ•¸æ“šåŸºæ–¼ç•¶å‰å¢ƒç•Œå¯æŒ‘æˆ°çš„è¬å¦–é¦–é ˜</div>
                </div>
                
                <div class="form-group">
                    <label for="tickets">é è¨ˆä½¿ç”¨è¬å¦–ä»¤æ•¸é‡ï¼š</label>
                    <input type="number" id="tickets" min="0" value="0">
                    <div class="info-text">æ¯å‘¨åŸºç¤3å ´è¬å¦–æŒ‘æˆ°ï¼Œä½¿ç”¨è¬å¦–ä»¤å¯å¢åŠ æŒ‘æˆ°å ´æ¬¡</div>
                </div>
                
                <div class="advance-options">
                    <div class="advance-title">é€²éšé¸é …ï¼š</div>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="considerWeek" checked>
                        <label for="considerWeek">è€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼ˆé€±ä¸‰è‡³é€±æ—¥ï¼‰</label>
                    </div>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="keepThreeBattles" checked>
                        <label for="keepThreeBattles">å˜—è©¦ç‚ºçªç ´ç•¶é€±ä¿ç•™3æ¬¡æŒ‘æˆ°æ©Ÿæœƒ</label>
                    </div>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="includeSundayBonus">
                        <label for="includeSundayBonus">è€ƒæ…®é€±æ—¥23:59çµç®—å¯å¤šå¾—å¦–é­„</label>
                    </div>
                    
                    <div id="sundayBonusOptions" style="display: none; margin-left: 25px; margin-top: 10px;">
                        <div class="form-group">
                            <label for="sundayRank">é€±æ—¥çµç®—æ’åï¼š</label>
                            <select id="sundayRank">
                                <option value="1">ç¬¬1åï¼ˆ+ï¼Ÿå¦–é­„ï¼‰</option>
                                <option value="2-3">ç¬¬2-3åï¼ˆ+ï¼Ÿå¦–é­„ï¼‰</option>
                                <option value="4-10">ç¬¬4-10åï¼ˆ+240å¦–é­„ï¼‰</option>
                                <option value="11-50">ç¬¬11-50åï¼ˆ+120å¦–é­„ï¼‰</option>
                                <option value="other">50åä»¥å¾Œï¼ˆç„¡é¡å¤–å¦–é­„ï¼‰</option>
                            </select>
                            <div class="info-text">æ’åè¶Šé«˜ï¼Œé€±æ—¥çµç®—é¡å¤–å¦–é­„è¶Šå¤š</div>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button id="calculateBtn">è¨ˆç®—å‡ç´šéœ€æ±‚</button>
                    <button id="resetBtn">é‡ç½®è¼¸å…¥</button>
                </div>
            </div>
            
            <div class="results-section">
                <h2 class="section-title">è¨ˆç®—çµæœ</h2>
                
                <div class="result-item">
                    <div class="result-title">å‡ç´šæ‰€éœ€ç¸½å¦–é­„</div>
                    <div class="result-value highlight" id="totalSouls">0</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">é‚„éœ€è¦æŒ‘æˆ°è¬å¦–æ¬¡æ•¸</div>
                    <div class="result-value" id="totalBattles">0 å ´</div>
                    <div class="info-text">åŸºæ–¼ç•¶å‰æ¯å ´å¯ç²å¦–é­„è¨ˆç®—</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">è€ƒæ…®è¬å¦–ä»¤å¾Œé‚„éœ€å ´æ¬¡</div>
                    <div class="result-value" id="battlesWithTickets">0 å ´</div>
                    <div class="info-text">ä½¿ç”¨é è¨ˆè¬å¦–ä»¤å¾Œä»éœ€æŒ‘æˆ°çš„æ¬¡æ•¸</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">å‡ç´šæ‰€éœ€æ™‚é–“ï¼ˆå‘¨ï¼‰</div>
                    <div class="result-value" id="weeksNeeded">0 å‘¨</div>
                    <div class="info-text">æŒ‰æ¯å‘¨3å ´è¨ˆç®—</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">å„å±¬æ€§å‡ç´šéœ€æ±‚</div>
                    <table class="breakdown-table">
                        <thead>
                            <tr>
                                <th>å±¬æ€§</th>
                                <th>ç•¶å‰ç­‰ç´š</th>
                                <th>ç›®æ¨™ç­‰ç´š</th>
                                <th>æ‰€éœ€å¦–é­„</th>
                            </tr>
                        </thead>
                        <tbody id="breakdownTable">
                            <!-- æ•¸æ“šå°‡ç”±JavaScriptå¡«å…… -->
                        </tbody>
                    </table>
                </div>
                
                <div class="result-item">
                    <div class="result-title">è·é›¢çªç ´å¯æŒ‘æˆ°æ¬¡æ•¸</div>
                    <div class="result-value" id="battlesBeforeBreakthrough">0 å ´</div>
                    <div class="info-text">åœ¨çªç ´å‰å¯å®Œæˆçš„è¬å¦–æŒ‘æˆ°æ¬¡æ•¸</div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">èƒ½å¦åœ¨çªç ´å‰å‡æ»¿</div>
                    <div class="result-value" id="canCompleteBeforeBreakthrough">--</div>
                    <div id="breakthroughMessage"></div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">çªç ´ç•¶é€±è¦åŠƒ</div>
                    <div id="breakthroughWeekPlan">--</div>
                    <div id="weekPlanDetails"></div>
                </div>
                
                <div class="result-item">
                    <div class="result-title">æœ€ä½³æŒ‘æˆ°ç­–ç•¥</div>
                    <div id="strategyTips">--</div>
                </div>
            </div>
        </div>
        
        <div class="note-box">
            <div class="note-title">ä½¿ç”¨èªªæ˜èˆ‡æ³¨æ„äº‹é …ï¼š</div>
            <p>1. æœ¬å·¥å…·æ•¸æ“šåŸºæ–¼ä¸€å¿µé€é™å®˜æ–¹æä¾›çš„åŒ–éˆå°å‡ç´šæ¶ˆè€—è¡¨ï¼Œåƒ…ä¾›åƒè€ƒã€‚</p>
            <p>2. è¬å¦–æŒ‘æˆ°æ¯é€±ä¸‰è‡³é€±æ—¥é–‹æ”¾ï¼Œé€±æ—¥23:59çµç®—ï¼Œå¯è€ƒæ…®åœ¨çµç®—å‰æŒ‘æˆ°ä»¥ç²å¾—æ›´å¤šå¦–é­„ã€‚</p>
            <p>3. çªç ´å¤§å¢ƒç•Œç•¶é€±å¯ä»¥æå‰å­˜å„²æŒ‘æˆ°æ¬¡æ•¸ï¼Œå»ºè­°åœ¨çªç ´å‰ä¿ç•™3æ¬¡æŒ‘æˆ°æ©Ÿæœƒã€‚</p>
            <p>4. çœŸä»™ã€é‡‘ä»™ã€å¤ªä¹™ã€å¤§ç¾…å››å€‹å¤§å¢ƒç•Œçš„åŒ–éˆå°å‡ç´šæ¶ˆè€—ç›¸åŒï¼Œä½†éŠæˆ²ä¸­éœ€åˆ†é–‹é¸æ“‡ã€‚</p>
            <p>5. é€±æ—¥çµç®—é¡å¤–å¦–é­„æ•¸æ“šï¼šç¬¬4-10å+240å¦–é­„ï¼Œç¬¬11-50å+120å¦–é­„ï¼Œå‰3åæ•¸æ“šå¾…è£œå……ã€‚</p>
            <p>6. <strong>å¦‚ä½•å®Œå–„é€±æ—¥çµç®—æ•¸æ“šï¼š</strong>åœ¨JavaScriptä»£ç¢¼ä¸­æ‰¾åˆ°"sundayBonus"å°è±¡ï¼Œè£œå……ç¬¬1åå’Œç¬¬2-3åçš„å¦–é­„æ•¸å€¼å³å¯ã€‚</p>
        </div>
        
        <footer>
            <p>ä¸€å¿µé€é™åŒ–éˆè‡ºå‡ç´šè¨ˆç®—å™¨ | æ•¸æ“šä¾†æºï¼šå®˜æ–¹åŒ–éˆå°æ¶ˆè€—è¡¨ | æœ¬å·¥å…·åƒ…ä¾›éŠæˆ²åƒè€ƒ</p>
            <p>Â© 2023 ä¸€å¿µé€é™æ”»ç•¥å·¥å…· | é©é…æ‰‹æ©Ÿã€å¹³æ¿ã€é›»è…¦</p>
        </footer>
    </div>

    <script>
        // åŒ–éˆè‡ºå‡ç´šæ¶ˆè€—æ•¸æ“š
        const soulData = {
            "äººç•Œ": {
                "ä¿®ç‚º": [20,20,35,35,35,45,45,45,55,55,75,75,75,100,100,120,120,120,140,140,175,175,175,210,210,240,240,285,285,350],
                "å“è³ª": [20,20,35,35,35,45,45,45,55,55,75,75,75,100,100,120,120,120,140,140,175,175,175,210,210,240,240,285,285,350],
                "éˆæ¹§": [25,25,30,30,30,35,35,35,45,45,55,55,55,70,70,80,80,80,90,90,100,100,100,115,115,125,125,150,150,180],
                "é«˜å“": [20,20,25,25,25,30,30,30,35,35,45,45,45,55,55,65,65,65,75,75,80,80,80,90,90,100,100,120,120,145]
            },
            "è¿”è™›": {
                "ä¿®ç‚º": [25,25,35,35,35,45,45,45,60,60,80,80,80,105,105,125,125,125,150,150,185,185,185,220,220,255,255,300,300,370],
                "å“è³ª": [35,35,50,50,50,70,70,70,85,85,120,120,120,155,155,190,190,190,225,225,280,280,280,330,330,380,380,450,450,555],
                "éˆæ¹§": [35,35,45,45,45,60,60,60,70,70,90,90,90,110,110,125,125,125,145,145,160,160,160,180,180,200,200,235,235,290],
                "é«˜å“": [25,25,35,35,35,40,40,40,50,50,65,65,65,75,75,90,90,90,100,100,115,115,115,125,125,140,140,165,165,200]
            },
            "åˆé«”": {
                "ä¿®ç‚º": [30,30,45,45,45,60,60,60,75,75,105,105,105,135,135,165,165,165,190,190,235,235,235,280,280,325,325,385,385,475],
                "å“è³ª": [45,45,65,65,65,90,90,90,110,110,155,155,155,200,200,245,245,245,290,290,355,355,355,420,420,490,490,575,575,710],
                "éˆæ¹§": [45,45,60,60,60,75,75,75,90,90,115,115,115,140,140,160,160,160,185,185,210,210,210,230,230,255,255,300,300,370],
                "é«˜å“": [30,30,40,40,40,50,50,50,65,65,80,80,80,95,95,115,115,115,130,130,145,145,145,160,160,180,180,210,210,260]
            },
            "å¤§æˆ": {
                "ä¿®ç‚º": [30,30,45,45,45,60,60,60,75,75,105,105,105,135,135,165,165,165,190,190,235,235,235,280,280,325,325,385,385,475],
                "å“è³ª": [45,45,65,65,65,90,90,90,110,110,155,155,155,200,200,245,245,245,290,290,355,355,355,420,420,490,490,575,575,710],
                "éˆæ¹§": [45,45,60,60,60,75,75,75,90,90,115,115,115,140,140,160,160,160,185,185,210,210,210,230,230,255,255,300,300,370],
                "é«˜å“": [30,30,40,40,40,50,50,50,65,65,80,80,80,95,95,115,115,115,130,130,145,145,145,160,160,180,180,210,210,260]
            },
            "æ¸¡åŠ«": {
                "ä¿®ç‚º": [40,40,60,60,60,80,80,80,100,100,140,140,140,180,180,220,220,220,265,265,325,325,325,385,385,445,445,525,525,645],
                "å“è³ª": [60,60,90,90,90,120,120,120,150,150,210,210,210,275,275,335,335,335,395,395,485,485,485,575,575,665,665,790,790,970],
                "éˆæ¹§": [65,65,80,80,80,100,100,100,125,125,155,155,155,190,190,220,220,220,250,250,285,285,285,315,315,345,345,410,410,505],
                "é«˜å“": [45,45,55,55,55,70,70,70,90,90,110,110,110,130,130,155,155,155,175,175,200,200,200,220,220,245,245,285,285,355]
            },
            "çœŸä»™": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            },
            "é‡‘ä»™": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            },
            "å¤ªä¹™": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            },
            "å¤§ç¾…": {
                "ä¿®ç‚º": [60,60,90,90,90,115,115,115,145,145,205,205,205,265,265,320,320,320,380,380,465,465,465,555,555,640,640,760,760,935],
                "å“è³ª": [90,90,130,130,130,175,175,175,220,220,305,305,305,395,395,480,480,480,570,570,700,700,700,830,830,965,965,1140,1140,1400],
                "éˆæ¹§": [90,90,120,120,120,145,145,145,180,180,230,230,230,275,275,320,320,320,365,365,410,410,410,455,455,500,500,590,590,730],
                "é«˜å“": [65,65,85,85,85,100,100,100,125,125,160,160,160,190,190,225,225,225,255,255,285,285,285,320,320,350,350,415,415,510]
            }
        };

        // å„å¢ƒç•Œè¬å¦–é¦–é ˜èˆ‡å¦–é­„æ•¸æ“š
        const monsterData = {
            "äººç•Œ": [
                { name: "ç„çŒ¿ç‹", power: "ç„¡", souls: 50 },
                { name: "ä¿®ç¾…ç‹", power: "4000è¬", souls: 80 },
                { name: "é¯¤éµ¬å¦–ç‹", power: "7000è¬", souls: 120 },
                { name: "é¦–é ˜å¦–ç¸", power: "8000è¬", souls: 180 }
            ],
            "è¿”è™›": [
                { name: "åŸºç¤å¦–ç¸", power: "ç„¡", souls: 80 },
                { name: "é€²éšå¦–ç¸", power: "3å„„", souls: 120 },
                { name: "ç²¾è‹±å¦–ç¸", power: "8å„„", souls: 180 },
                { name: "é¦–é ˜å¦–ç¸", power: "15å„„", souls: 250 }
            ],
            "åˆé«”": [
                { name: "åŸºç¤å¦–ç¸", power: "ç„¡", souls: 120 },
                { name: "é€²éšå¦–ç¸", power: "30å„„", souls: 180 },
                { name: "ç²¾è‹±å¦–ç¸", power: "80å„„", souls: 250 },
                { name: "é¦–é ˜å¦–ç¸", power: "150å„„", souls: 350 }
            ],
            "å¤§æˆ": [
                { name: "åŸºç¤å¦–ç¸", power: "ç„¡", souls: 150 },
                { name: "é€²éšå¦–ç¸", power: "200å„„", souls: 220 },
                { name: "ç²¾è‹±å¦–ç¸", power: "500å„„", souls: 300 },
                { name: "é¦–é ˜å¦–ç¸", power: "1000å„„", souls: 400 }
            ],
            "æ¸¡åŠ«": [
                { name: "åŸºç¤å¦–ç¸", power: "ç„¡", souls: 200 },
                { name: "è’¼ç„å·«ç‹", power: "3000å„„", souls: 300 },
                { name: "å˜¯æœˆç‹¼ç‹", power: "3600å„„", souls: 400 },
                { name: "æ·±æ·µæ°äºº", power: "4200å„„", souls: 500 },
                { name: "è’¼éˆå¤”ç‰›ç‹", power: "5000å„„", souls: 500 }
            ],
            "çœŸä»™": [
                { name: "æœ±å­å¤©ç‹", power: "ç„¡", souls: 120 },
                { name: "é¢¨éˆå¤©ç‰", power: "1.0è¬å„„", souls: 180 },
                { name: "å…©é»ƒå¤©ç‹", power: "1.2è¬å„„", souls: 210 },
                { name: "æ¶…æ§ƒé³³ç‹", power: "1.4è¬å„„", souls: 250 },
                { name: "ä¹éœ„éº’éºŸä¸»", power: "1.6è¬å„„", souls: 280 },
                { name: "é­”å°‡ç›¸æŸ³", power: "1.8è¬å„„", souls: 310 },
            ],
            "é‡‘ä»™": [
                { name: "åŸºç¤å¦–ç¸", power: "ç„¡", souls: 200 },
                { name: "é€²éšå¦–ç¸", power: "2.5è¬å„„", souls: 300 },
                { name: "ç²¾è‹±å¦–ç¸", power: "3.0è¬å„„", souls: 350 },
                { name: "é¦–é ˜å¦–ç¸", power: "3.5è¬å„„", souls: 400 },
                { name: "ç¥ç¸æœ±é›€", power: "4.0è¬å„„", souls: 450 },
                { name: "ç¥ç¸ç„æ­¦", power: "4.5è¬å„„", souls: 500 }
            ],
            "å¤ªä¹™": [
                { name: "é‡‘çƒå¤©ç‹", power: "ç„¡", souls: 250 },
                { name: "æ­¸å¢Ÿéµ¬ç‹", power: "11è¬å„„", souls: 350 },
                { name: "ç¥¸æ–—å¤©ç‹", power: "13è¬å„„", souls: 400 },
                { name: "å¾¡é¾œå¤©ç‹", power: "15è¬å„„", souls: 450 },
                { name: "è¦†æµ·è­é¾ç‹", power: "17è¬å„„", souls: 500 },
                { name: "é­”å°‡ç¦ºç–†", power: "20è¬å„„", souls: 550 }
            ],
            "å¤§ç¾…": [
                { name: "åŸºç¤å¦–ç¸", power: "ç„¡", souls: 300 },
                { name: "é€²éšå¦–ç¸", power: "10è¬å„„", souls: 400 },
                { name: "ç²¾è‹±å¦–ç¸", power: "12è¬å„„", souls: 450 },
                { name: "é¦–é ˜å¦–ç¸", power: "15è¬å„„", souls: 500 },
                { name: "ç¥ç¸æ··æ²Œ", power: "18è¬å„„", souls: 550 },
                { name: "ç¥ç¸é¥•é¤®", power: "20è¬å„„", souls: 600 }
            ]
        };

        // é€±æ—¥çµç®—é¡å¤–å¦–é­„æ•¸æ“šï¼ˆç¬¬1åå’Œç¬¬2-3åéœ€è¦å®Œå–„ï¼‰
        const sundayBonus = {
            "1": 0, // ç¬¬1åï¼ˆå¾…è£œå……ï¼Œä¾‹å¦‚ï¼š500ï¼‰
            "2-3": 0, // ç¬¬2-3åï¼ˆå¾…è£œå……ï¼Œä¾‹å¦‚ï¼š300ï¼‰
            "4-10": 240, // ç¬¬4-10å
            "11-50": 120, // ç¬¬11-50å
            "other": 0 // 50åä»¥å¾Œ
        };

        // DOMå…ƒç´ 
        const realmSelect = document.getElementById('realm');
        const cultivationSelect = document.getElementById('cultivation');
        const qualitySelect = document.getElementById('quality');
        const spiritFlowSelect = document.getElementById('spiritFlow');
        const highQualitySelect = document.getElementById('highQuality');
        const monsterSelect = document.getElementById('monsterSelect');
        const monsterPowerEl = document.getElementById('monsterPower');
        const monsterSoulsEl = document.getElementById('monsterSouls');
        const ticketsInput = document.getElementById('tickets');
        
        // æ™‚é–“ç›¸é—œå…ƒç´ 
        const daysToBreakthroughInput = document.getElementById('daysToBreakthrough');
        const hoursToBreakthroughInput = document.getElementById('hoursToBreakthrough');
        const minutesToBreakthroughInput = document.getElementById('minutesToBreakthrough');
        const countdownContainer = document.getElementById('countdownContainer');
        const countdownDaysEl = document.getElementById('countdownDays');
        const countdownHoursEl = document.getElementById('countdownHours');
        const countdownMinutesEl = document.getElementById('countdownMinutes');
        const currentBeijingTimeEl = document.getElementById('currentBeijingTime');
        
        // é€²éšé¸é …å…ƒç´ 
        const considerWeekCheckbox = document.getElementById('considerWeek');
        const keepThreeBattlesCheckbox = document.getElementById('keepThreeBattles');
        const includeSundayBonusCheckbox = document.getElementById('includeSundayBonus');
        const sundayBonusOptions = document.getElementById('sundayBonusOptions');
        const sundayRankSelect = document.getElementById('sundayRank');
        
        // çµæœå…ƒç´ 
        const totalSoulsEl = document.getElementById('totalSouls');
        const totalBattlesEl = document.getElementById('totalBattles');
        const battlesWithTicketsEl = document.getElementById('battlesWithTickets');
        const weeksNeededEl = document.getElementById('weeksNeeded');
        const breakdownTableEl = document.getElementById('breakdownTable');
        
        // æ™‚é–“è¦åŠƒçµæœå…ƒç´ 
        const battlesBeforeBreakthroughEl = document.getElementById('battlesBeforeBreakthrough');
        const canCompleteBeforeBreakthroughEl = document.getElementById('canCompleteBeforeBreakthrough');
        const breakthroughMessageEl = document.getElementById('breakthroughMessage');
        const breakthroughWeekPlanEl = document.getElementById('breakthroughWeekPlan');
        const weekPlanDetailsEl = document.getElementById('weekPlanDetails');
        const strategyTipsEl = document.getElementById('strategyTips');
        
        // æŒ‰éˆ•
        const calculateBtn = document.getElementById('calculateBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        // ç•¶å‰é¸æ“‡çš„å¦–é­„æ•¸é‡
        let currentSoulsPerBattle = 0;
        
        // å€’æ•¸è¨ˆæ™‚å™¨è®Šæ•¸
        let countdownTimer = null;
        let breakthroughTime = null;
        
        // ç²å–åŒ—äº¬æ™‚é–“å‡½æ•¸
        function getBeijingTime() {
            // åŒ—äº¬æ™‚é–“æ˜¯UTC+8
            const now = new Date();
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            // è½‰æ›ç‚ºåŒ—äº¬æ™‚é–“ (UTC+8)
            return new Date(utc + (3600000 * 8));
        }
        
        // æ ¼å¼åŒ–æ™‚é–“é¡¯ç¤º
        function formatTime(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            const seconds = String(date.getSeconds()).padStart(2, '0');
            return `${year}å¹´${month}æœˆ${day}æ—¥ ${hours}:${minutes}:${seconds}`;
        }
        
        // æ›´æ–°ç•¶å‰åŒ—äº¬æ™‚é–“é¡¯ç¤º
        function updateBeijingTime() {
            const beijingTime = getBeijingTime();
            currentBeijingTimeEl.textContent = formatTime(beijingTime);
        }
        
        // åˆå§‹åŒ–ç­‰ç´šä¸‹æ‹‰é¸å–®
        function initLevelSelects() {
            const levelOptions = [];
            for (let i = 0; i <= 30; i++) {
                levelOptions.push(`<option value="${i}">${i}ç´š</option>`);
            }
            
            cultivationSelect.innerHTML = levelOptions.join('');
            qualitySelect.innerHTML = levelOptions.join('');
            spiritFlowSelect.innerHTML = levelOptions.join('');
            highQualitySelect.innerHTML = levelOptions.join('');
            
            // è¨­ç½®é»˜èªå€¼
            cultivationSelect.value = 0;
            qualitySelect.value = 0;
            spiritFlowSelect.value = 0;
            highQualitySelect.value = 0;
        }
        
        // åˆå§‹åŒ–è¬å¦–é¦–é ˜é¸æ“‡
        function initMonsterSelect() {
            const realm = realmSelect.value;
            const monsters = monsterData[realm] || [];
            
            let options = '';
            monsters.forEach(monster => {
                // æ ¼å¼åŒ–é¡¯ç¤ºï¼šæˆ°åŠ› - åç¨± - å¦–é­„
                let displayText = '';
                if (monster.power === "ç„¡") {
                    displayText = `${monster.name} - ${monster.souls}å¦–é­„`;
                } else {
                    // æå–æ•¸å€¼éƒ¨åˆ†ç”¨æ–¼æ’åº
                    let powerValue = monster.power;
                    // ç§»é™¤å–®ä½ä»¥ä¾¿æ’åº
                    if (powerValue.includes("è¬å„„")) {
                        powerValue = parseFloat(powerValue.replace("è¬å„„", ""));
                        // å°‡è¬å„„è½‰æ›ç‚ºæ•¸å­—ç”¨æ–¼æ’åº
                        displayText = `${monster.power.replace("è¬å„„", "")} - ${monster.name} - ${monster.souls}å¦–é­„`;
                    } else if (powerValue.includes("å„„")) {
                        powerValue = parseFloat(powerValue.replace("å„„", ""));
                        displayText = `${monster.power} - ${monster.name} - ${monster.souls}å¦–é­„`;
                    } else {
                        displayText = `${monster.power} - ${monster.name} - ${monster.souls}å¦–é­„`;
                    }
                }
                
                options += `<option value="${monster.souls}" data-power="${monster.power}" data-name="${monster.name}">${displayText}</option>`;
            });
            
            monsterSelect.innerHTML = options;
            
            // æ›´æ–°é¡¯ç¤º
            if (monsters.length > 0) {
                const firstMonster = monsters[0];
                monsterPowerEl.textContent = `æˆ°åŠ›è¦æ±‚ï¼š${firstMonster.power}`;
                monsterSoulsEl.textContent = `å¦–é­„ï¼š${firstMonster.souls}`;
                currentSoulsPerBattle = firstMonster.souls;
            }
        }
        
        // æ›´æ–°è¬å¦–é¦–é ˜é¸æ“‡
        function updateMonsterSelect() {
            const selectedValue = monsterSelect.value;
            const selectedOption = monsterSelect.options[monsterSelect.selectedIndex];
            const power = selectedOption.getAttribute('data-power');
            const name = selectedOption.getAttribute('data-name');
            
            monsterPowerEl.textContent = `æˆ°åŠ›è¦æ±‚ï¼š${power}`;
            monsterSoulsEl.textContent = `å¦–é­„ï¼š${selectedValue}`;
            currentSoulsPerBattle = parseInt(selectedValue);
        }
        
        // é–‹å§‹å€’æ•¸è¨ˆæ™‚
        function startCountdown() {
            // æ¸…é™¤ç¾æœ‰çš„è¨ˆæ™‚å™¨
            if (countdownTimer) {
                clearInterval(countdownTimer);
            }
            
            const days = parseInt(daysToBreakthroughInput.value) || 0;
            const hours = parseInt(hoursToBreakthroughInput.value) || 0;
            const minutes = parseInt(minutesToBreakthroughInput.value) || 0;
            
            // å¦‚æœæ²’æœ‰è¨­å®šæ™‚é–“ï¼Œéš±è—å€’æ•¸è¨ˆæ™‚
            if (days === 0 && hours === 0 && minutes === 0) {
                countdownContainer.style.display = "none";
                return;
            }
            
            // è¨ˆç®—çªç ´æ™‚é–“ï¼ˆç•¶å‰åŒ—äº¬æ™‚é–“ + è¨­å®šçš„æ™‚é–“ï¼‰
            breakthroughTime = getBeijingTime();
            breakthroughTime.setDate(breakthroughTime.getDate() + days);
            breakthroughTime.setHours(breakthroughTime.getHours() + hours);
            breakthroughTime.setMinutes(breakthroughTime.getMinutes() + minutes);
            
            // é¡¯ç¤ºå€’æ•¸è¨ˆæ™‚å®¹å™¨
            countdownContainer.style.display = "block";
            
            // ç«‹å³æ›´æ–°ä¸€æ¬¡å€’æ•¸è¨ˆæ™‚
            updateCountdown();
            
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡å€’æ•¸è¨ˆæ™‚
            countdownTimer = setInterval(updateCountdown, 1000);
        }
        
        // æ›´æ–°å€’æ•¸è¨ˆæ™‚é¡¯ç¤º
        function updateCountdown() {
            if (!breakthroughTime) return;
            
            const now = getBeijingTime();
            const timeRemaining = breakthroughTime - now;
            
            // å¦‚æœæ™‚é–“å·²éï¼Œé¡¯ç¤º0
            if (timeRemaining <= 0) {
                countdownDaysEl.textContent = "00";
                countdownHoursEl.textContent = "00";
                countdownMinutesEl.textContent = "00";
                countdownSecondsEl.textContent = "00";
                clearInterval(countdownTimer);
                return;
            }
            
            // è¨ˆç®—å¤©ã€å°æ™‚ã€åˆ†é˜ã€ç§’
            const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
            
            // æ›´æ–°é¡¯ç¤º
            countdownDaysEl.textContent = days.toString().padStart(2, '0');
            countdownHoursEl.textContent = hours.toString().padStart(2, '0');
            countdownMinutesEl.textContent = minutes.toString().padStart(2, '0');
            countdownSecondsEl.textContent = seconds.toString().padStart(2, '0');
        }
        
        // è¨ˆç®—å‡ç´šéœ€æ±‚
        function calculateUpgradeNeeds() {
            const realm = realmSelect.value;
            const cultivationLevel = parseInt(cultivationSelect.value) || 0;
            const qualityLevel = parseInt(qualitySelect.value) || 0;
            const spiritFlowLevel = parseInt(spiritFlowSelect.value) || 0;
            const highQualityLevel = parseInt(highQualitySelect.value) || 0;
            const perBattle = currentSoulsPerBattle || 0;
            const tickets = parseInt(ticketsInput.value) || 0;
            
            // ç²å–ç•¶å‰å¢ƒç•Œçš„æ•¸æ“š
            const realmData = soulData[realm];
            
            // è¨ˆç®—æ¯å€‹å±¬æ€§é‚„éœ€è¦çš„å¦–é­„
            const cultivationNeeded = calculateAttributeNeeds(realmData["ä¿®ç‚º"], cultivationLevel);
            const qualityNeeded = calculateAttributeNeeds(realmData["å“è³ª"], qualityLevel);
            const spiritFlowNeeded = calculateAttributeNeeds(realmData["éˆæ¹§"], spiritFlowLevel);
            const highQualityNeeded = calculateAttributeNeeds(realmData["é«˜å“"], highQualityLevel);
            
            // è¨ˆç®—ç¸½éœ€æ±‚
            const totalNeeded = cultivationNeeded + qualityNeeded + spiritFlowNeeded + highQualityNeeded;
            
            // è¨ˆç®—é‚„éœ€è¦æŒ‘æˆ°çš„æ¬¡æ•¸
            const battlesNeeded = perBattle > 0 ? Math.ceil(totalNeeded / perBattle) : 0;
            
            // è€ƒæ…®è¬å¦–ä»¤å¾Œçš„å ´æ¬¡ï¼ˆæ¯é€±åŸºç¤3å ´ï¼Œè¬å¦–ä»¤å¯å¢åŠ å ´æ¬¡ï¼‰
            const battlesAfterTickets = Math.max(0, battlesNeeded - tickets);
            
            // è¨ˆç®—éœ€è¦å¤šå°‘å‘¨ï¼ˆæ¯é€±3å ´ï¼‰
            const weeksNeeded = Math.ceil(battlesAfterTickets / 3);
            
            // æ›´æ–°é¡¯ç¤º
            totalSoulsEl.textContent = formatNumber(totalNeeded);
            totalBattlesEl.textContent = `${battlesNeeded} å ´`;
            battlesWithTicketsEl.textContent = `${battlesAfterTickets} å ´`;
            weeksNeededEl.textContent = `${weeksNeeded} å‘¨`;
            
            // æ›´æ–°æ˜ç´°è¡¨
            updateBreakdownTable(
                cultivationLevel, cultivationNeeded,
                qualityLevel, qualityNeeded,
                spiritFlowLevel, spiritFlowNeeded,
                highQualityLevel, highQualityNeeded
            );
            
            // è¨ˆç®—æ™‚é–“è¦åŠƒ
            calculateTimePlan(totalNeeded, perBattle, tickets, battlesNeeded, battlesAfterTickets);
        }
        
        // è¨ˆç®—å–®å€‹å±¬æ€§å‡ç´šæ‰€éœ€å¦–é­„
        function calculateAttributeNeeds(costArray, currentLevel) {
            let total = 0;
            // å¾ç•¶å‰ç­‰ç´šå‡åˆ°30ç´šéœ€è¦çš„å¦–é­„
            for (let i = currentLevel; i < 30; i++) {
                total += costArray[i];
            }
            return total;
        }
        
        // æ›´æ–°æ˜ç´°è¡¨
        function updateBreakdownTable(cultivationLevel, cultivationNeeded, qualityLevel, qualityNeeded, spiritFlowLevel, spiritFlowNeeded, highQualityLevel, highQualityNeeded) {
            const attributes = [
                { name: "ä¿®ç‚º", current: cultivationLevel, needed: cultivationNeeded },
                { name: "å“è³ª", current: qualityLevel, needed: qualityNeeded },
                { name: "éˆæ¹§", current: spiritFlowLevel, needed: spiritFlowNeeded },
                { name: "é«˜å“", current: highQualityLevel, needed: highQualityNeeded }
            ];
            
            let tableHTML = '';
            attributes.forEach(attr => {
                tableHTML += `
                    <tr>
                        <td>${attr.name}</td>
                        <td>${attr.current}</td>
                        <td>30</td>
                        <td>${formatNumber(attr.needed)}</td>
                    </tr>
                `;
            });
            
            breakdownTableEl.innerHTML = tableHTML;
        }
        
        // è¨ˆç®—æ™‚é–“è¦åŠƒ
        function calculateTimePlan(totalNeeded, perBattle, tickets, battlesNeeded, battlesAfterTickets) {
            const days = parseInt(daysToBreakthroughInput.value) || 0;
            const hours = parseInt(hoursToBreakthroughInput.value) || 0;
            const minutes = parseInt(minutesToBreakthroughInput.value) || 0;
            const considerWeek = considerWeekCheckbox.checked;
            const keepThreeBattles = keepThreeBattlesCheckbox.checked;
            const includeSundayBonus = includeSundayBonusCheckbox.checked;
            const sundayRank = sundayRankSelect.value;
            
            // è¨ˆç®—ç¸½åˆ†é˜æ•¸
            const totalMinutes = days * 24 * 60 + hours * 60 + minutes;
            
            if (totalMinutes === 0) {
                // æ²’æœ‰è¼¸å…¥çªç ´æ™‚é–“
                battlesBeforeBreakthroughEl.textContent = "è«‹è¼¸å…¥çªç ´æ™‚é–“";
                canCompleteBeforeBreakthroughEl.textContent = "--";
                canCompleteBeforeBreakthroughEl.className = "result-value";
                breakthroughMessageEl.innerHTML = "";
                breakthroughWeekPlanEl.textContent = "è«‹è¼¸å…¥çªç ´æ™‚é–“ä»¥é€²è¡Œè¦åŠƒ";
                weekPlanDetailsEl.textContent = "";
                strategyTipsEl.textContent = "è«‹è¼¸å…¥çªç ´æ™‚é–“ä»¥ç²å¾—æœ€ä½³ç­–ç•¥å»ºè­°";
                return;
            }
            
            // è¨ˆç®—æ¯å ´å¯¦éš›å¯ç²å¦–é­„ï¼ˆè€ƒæ…®é€±æ—¥çµç®—çå‹µï¼‰
            let actualPerBattle = perBattle;
            if (includeSundayBonus && perBattle > 0) {
                // å‡è¨­æ¯5å ´ä¸­æœ‰1å ´æ˜¯é€±æ—¥çµç®—ï¼ˆç°¡åŒ–è¨ˆç®—ï¼‰
                const sundayBonusValue = sundayBonus[sundayRank];
                actualPerBattle = perBattle + (sundayBonusValue / 5);
            }
            
            // é‡æ–°è¨ˆç®—è€ƒæ…®é€±æ—¥çå‹µå¾Œçš„æŒ‘æˆ°æ¬¡æ•¸
            let actualBattlesNeeded = perBattle > 0 ? Math.ceil(totalNeeded / actualPerBattle) : 0;
            let actualBattlesAfterTickets = Math.max(0, actualBattlesNeeded - tickets);
            
            // å¦‚æœè€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼ˆé€±ä¸‰è‡³é€±æ—¥ï¼‰
            let battlesBeforeBreakthrough = 0;
            let message = "";
            let weekPlan = "";
            let weekDetails = "";
            let strategy = "";
            
            if (considerWeek) {
                // ç°¡å–®è¨ˆç®—ï¼šå‡è¨­æ¯é€±æœ‰5å¤©é–‹æ”¾ï¼Œä½†æ¯é€±åªèƒ½æ‰“3å ´
                const totalHours = totalMinutes / 60;
                const daysAvailable = Math.floor(totalHours / 24);
                const weeksAvailable = Math.floor(daysAvailable / 7);
                const remainingDays = daysAvailable % 7;
                
                // æ¯é€±å¯æ‰“3å ´
                battlesBeforeBreakthrough = weeksAvailable * 3;
                
                // å‰©é¤˜å¤©æ•¸ä¸­ï¼Œå¦‚æœæ˜¯é€±ä¸‰åˆ°é€±æ—¥ï¼Œå‰‡å¯èƒ½é‚„å¯ä»¥æ‰“
                // é€™è£¡ç°¡åŒ–è¨ˆç®—ï¼šå‡è¨­å‰©é¤˜å¤©æ•¸ä¸­æœ‰3/7çš„æ©Ÿæœƒå¯ä»¥æ‰“ï¼ˆå¯¦éš›å–æ±ºæ–¼å…·é«”æ˜ŸæœŸå¹¾ï¼‰
                const possibleBattlesInRemainingDays = Math.min(3, Math.floor(remainingDays * 3 / 5));
                battlesBeforeBreakthrough += possibleBattlesInRemainingDays;
                
                message = `è·é›¢çªç ´é‚„æœ‰ç´„ ${days} å¤© ${hours} å°æ™‚ ${minutes} åˆ†é˜ï¼Œè€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼Œé è¨ˆå¯å®Œæˆ ${battlesBeforeBreakthrough} å ´æŒ‘æˆ°ã€‚`;
                
                // æª¢æŸ¥æ˜¯å¦å¯ä»¥åœ¨çªç ´å‰å®Œæˆ
                if (actualBattlesAfterTickets <= battlesBeforeBreakthrough) {
                    canCompleteBeforeBreakthroughEl.textContent = "å¯ä»¥";
                    canCompleteBeforeBreakthroughEl.className = "result-value success";
                    breakthroughMessageEl.innerHTML = `<span class="success">âœ“ æ­å–œï¼æ‚¨å¯ä»¥åœ¨çªç ´å‰å®ŒæˆåŒ–éˆè‡ºå‡ç´šã€‚</span>`;
                } else {
                    canCompleteBeforeBreakthroughEl.textContent = "ç„¡æ³•";
                    canCompleteBeforeBreakthroughEl.className = "result-value warning";
                    const remainingBattles = actualBattlesAfterTickets - battlesBeforeBreakthrough;
                    breakthroughMessageEl.innerHTML = `<span class="warning">âœ— ç„¡æ³•åœ¨çªç ´å‰å®Œæˆå‡ç´šï¼Œé‚„å·® ${remainingBattles} å ´è¬å¦–æŒ‘æˆ°ã€‚</span>`;
                }
                
                // çªç ´ç•¶é€±è¦åŠƒ
                if (keepThreeBattles) {
                    weekPlan = "å»ºè­°ç‚ºçªç ´ç•¶é€±ä¿ç•™3æ¬¡æŒ‘æˆ°æ©Ÿæœƒ";
                    
                    // è¨ˆç®—ä»Šå¤©æ˜ŸæœŸå¹¾
                    const today = getBeijingTime();
                    const dayOfWeek = today.getDay(); // 0=é€±æ—¥, 1=é€±ä¸€, ...
                    
                    // çªç ´æ—¥æœŸ
                    const breakthroughDate = getBeijingTime();
                    breakthroughDate.setDate(breakthroughDate.getDate() + days);
                    breakthroughDate.setHours(breakthroughDate.getHours() + hours);
                    breakthroughDate.setMinutes(breakthroughDate.getMinutes() + minutes);
                    
                    // åˆ¤æ–·çªç ´ç•¶é€±æ˜¯å¦é‚„æœ‰æŒ‘æˆ°æ©Ÿæœƒ
                    const breakthroughDayOfWeek = breakthroughDate.getDay();
                    
                    // å¦‚æœçªç ´æ™‚é–“åœ¨é€±ä¸‰è‡³é€±æ—¥ä¹‹é–“ï¼Œå‰‡æœ‰æ©Ÿæœƒ
                    if (breakthroughDayOfWeek >= 3 || breakthroughDayOfWeek === 0) {
                        weekDetails = "çªç ´ç•¶å¤©åœ¨è¬å¦–é–‹æ”¾æ™‚é–“å…§ï¼Œå¯ä»¥ä½¿ç”¨ä¿ç•™çš„3æ¬¡æŒ‘æˆ°æ©Ÿæœƒã€‚";
                    } else {
                        weekDetails = "çªç ´ç•¶å¤©ä¸åœ¨è¬å¦–é–‹æ”¾æ™‚é–“å…§ï¼ˆé€±ä¸€æˆ–é€±äºŒï¼‰ï¼Œå»ºè­°æå‰ä½¿ç”¨æŒ‘æˆ°æ©Ÿæœƒã€‚";
                    }
                } else {
                    weekPlan = "ä¸ä¿ç•™æŒ‘æˆ°æ©Ÿæœƒï¼Œç›¡å¿«å®Œæˆå‡ç´š";
                    weekDetails = "å»ºè­°åœ¨çªç ´å‰ç›¡å¯èƒ½å®Œæˆæ›´å¤šæŒ‘æˆ°ï¼Œä»¥ç¢ºä¿å‡ç´šå®Œæˆã€‚";
                }
                
                // ç­–ç•¥å»ºè­°
                strategy = "ç­–ç•¥å»ºè­°ï¼š";
                if (includeSundayBonus) {
                    const bonusAmount = sundayBonus[sundayRank];
                    if (bonusAmount > 0) {
                        strategy += ` ç›¡é‡åœ¨é€±æ—¥23:59å‰å®ŒæˆæŒ‘æˆ°ä»¥ç²å¾—é¡å¤–${bonusAmount}å¦–é­„çå‹µã€‚`;
                    }
                }
                
                if (tickets > 0) {
                    strategy += ` æ‚¨è¨ˆåŠƒä½¿ç”¨ ${tickets} å€‹è¬å¦–ä»¤ï¼Œå¯ä»¥åœ¨é—œéµæ™‚åˆ»ä½¿ç”¨ä»¥åŠ é€Ÿå‡ç´šã€‚`;
                }
                
                if (days < 7) {
                    strategy += " çªç ´æ™‚é–“è¼ƒè¿‘ï¼Œå»ºè­°å„ªå…ˆå‡ç´šæœ€é‡è¦çš„å±¬æ€§ï¼ˆä¿®ç‚º/å“è³ªï¼‰ã€‚";
                }
                
                // æ ¹æ“šå¦–é­„ç²å–é‡çµ¦å»ºè­°
                if (currentSoulsPerBattle < 200) {
                    strategy += " ç•¶å‰æ¯å ´ç²å–çš„å¦–é­„è¼ƒå°‘ï¼Œå»ºè­°å„ªå…ˆæŒ‘æˆ°æ›´é«˜ç´šçš„è¬å¦–é¦–é ˜ã€‚";
                }
                
            } else {
                // ä¸è€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼Œç°¡å–®æŒ‰å¤©è¨ˆç®—
                const totalHours = totalMinutes / 60;
                const weeks = Math.floor(totalHours / (24 * 7));
                const remainingDays = Math.floor((totalHours % (24 * 7)) / 24);
                
                battlesBeforeBreakthrough = weeks * 3;
                if (remainingDays > 0) {
                    battlesBeforeBreakthrough += Math.min(3, 1); // å‡è¨­å‰©é¤˜å¤©æ•¸è‡³å°‘å¯ä»¥æ‰“1å ´
                }
                
                message = `è·é›¢çªç ´é‚„æœ‰ç´„ ${days} å¤© ${hours} å°æ™‚ ${minutes} åˆ†é˜ï¼Œé è¨ˆå¯å®Œæˆ ${battlesBeforeBreakthrough} å ´æŒ‘æˆ°ã€‚`;
                
                // æª¢æŸ¥æ˜¯å¦å¯ä»¥åœ¨çªç ´å‰å®Œæˆ
                if (actualBattlesAfterTickets <= battlesBeforeBreakthrough) {
                    canCompleteBeforeBreakthroughEl.textContent = "å¯ä»¥";
                    canCompleteBeforeBreakthroughEl.className = "result-value success";
                    breakthroughMessageEl.innerHTML = `<span class="success">âœ“ æ­å–œï¼æ‚¨å¯ä»¥åœ¨çªç ´å‰å®ŒæˆåŒ–éˆè‡ºå‡ç´šã€‚</span>`;
                } else {
                    canCompleteBeforeBreakthroughEl.textContent = "ç„¡æ³•";
                    canCompleteBeforeBreakthroughEl.className = "result-value warning";
                    const remainingBattles = actualBattlesAfterTickets - battlesBeforeBreakthrough;
                    breakthroughMessageEl.innerHTML = `<span class="warning">âœ— ç„¡æ³•åœ¨çªç ´å‰å®Œæˆå‡ç´šï¼Œé‚„å·® ${remainingBattles} å ´è¬å¦–æŒ‘æˆ°ã€‚</span>`;
                }
                
                weekPlan = "æœªè€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ï¼Œè¦åŠƒå¯èƒ½ä¸æº–ç¢º";
                weekDetails = "";
                strategy = "å»ºè­°å•Ÿç”¨ã€Œè€ƒæ…®è¬å¦–é–‹æ”¾æ™‚é–“ã€é¸é …ä»¥ç²å¾—ç²¾ç¢ºè¦åŠƒã€‚";
            }
            
            // æ›´æ–°é¡¯ç¤º
            battlesBeforeBreakthroughEl.textContent = `${battlesBeforeBreakthrough} å ´`;
            breakthroughWeekPlanEl.textContent = weekPlan;
            weekPlanDetailsEl.textContent = weekDetails;
            strategyTipsEl.textContent = strategy;
        }
        
        // æ ¼å¼åŒ–æ•¸å­—ï¼ˆæ·»åŠ åƒä½åˆ†éš”ç¬¦ï¼‰
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // é‡ç½®è¡¨å–®
        function resetForm() {
            realmSelect.value = "äººç•Œ";
            cultivationSelect.value = "0";
            qualitySelect.value = "0";
            spiritFlowSelect.value = "0";
            highQualitySelect.value = "0";
            ticketsInput.value = "0";
            daysToBreakthroughInput.value = "0";
            hoursToBreakthroughInput.value = "0";
            minutesToBreakthroughInput.value = "0";
            countdownContainer.style.display = "none";
            considerWeekCheckbox.checked = true;
            keepThreeBattlesCheckbox.checked = true;
            includeSundayBonusCheckbox.checked = false;
            sundayRankSelect.value = "4-10";
            sundayBonusOptions.style.display = "none";
            
            // æ¸…é™¤å€’æ•¸è¨ˆæ™‚å™¨
            if (countdownTimer) {
                clearInterval(countdownTimer);
                countdownTimer = null;
            }
            
            // é‡æ–°åˆå§‹åŒ–è¬å¦–é¸æ“‡
            initMonsterSelect();
            
            // é‡ç½®çµæœ
            totalSoulsEl.textContent = "0";
            totalBattlesEl.textContent = "0 å ´";
            battlesWithTicketsEl.textContent = "0 å ´";
            weeksNeededEl.textContent = "0 å‘¨";
            breakdownTableEl.innerHTML = "";
            
            battlesBeforeBreakthroughEl.textContent = "0 å ´";
            canCompleteBeforeBreakthroughEl.textContent = "--";
            canCompleteBeforeBreakthroughEl.className = "result-value";
            breakthroughMessageEl.innerHTML = "";
            breakthroughWeekPlanEl.textContent = "--";
            weekPlanDetailsEl.textContent = "";
            strategyTipsEl.textContent = "--";
        }
        
        // äº‹ä»¶ç›£è½å™¨
        calculateBtn.addEventListener('click', calculateUpgradeNeeds);
        resetBtn.addEventListener('click', resetForm);
        
        // ç•¶çªç ´æ™‚é–“è®ŠåŒ–æ™‚ï¼Œæ›´æ–°å€’æ•¸è¨ˆæ™‚
        daysToBreakthroughInput.addEventListener('input', startCountdown);
        hoursToBreakthroughInput.addEventListener('input', startCountdown);
        minutesToBreakthroughInput.addEventListener('input', startCountdown);
        
        // ç•¶å¢ƒç•Œè®ŠåŒ–æ™‚ï¼Œæ›´æ–°è¬å¦–é¸æ“‡
        realmSelect.addEventListener('change', function() {
            initMonsterSelect();
            calculateUpgradeNeeds();
        });
        
        // ç•¶è¬å¦–é¸æ“‡è®ŠåŒ–æ™‚
        monsterSelect.addEventListener('change', function() {
            updateMonsterSelect();
            calculateUpgradeNeeds();
        });
        
        // ç•¶é€±æ—¥çµç®—é¸é …è®ŠåŒ–æ™‚ï¼Œé¡¯ç¤º/éš±è—æ’åé¸æ“‡
        includeSundayBonusCheckbox.addEventListener('change', function() {
            if (this.checked) {
                sundayBonusOptions.style.display = "block";
            } else {
                sundayBonusOptions.style.display = "none";
            }
            calculateUpgradeNeeds();
        });
        
        // ç•¶å±¬æ€§ç­‰ç´šè®ŠåŒ–æ™‚ï¼Œé‡æ–°è¨ˆç®—
        cultivationSelect.addEventListener('change', calculateUpgradeNeeds);
        qualitySelect.addEventListener('change', calculateUpgradeNeeds);
        spiritFlowSelect.addEventListener('change', calculateUpgradeNeeds);
        highQualitySelect.addEventListener('change', calculateUpgradeNeeds);
        
        // ç•¶è¬å¦–ä»¤æ•¸é‡è®ŠåŒ–æ™‚ï¼Œé‡æ–°è¨ˆç®—
        ticketsInput.addEventListener('input', calculateUpgradeNeeds);
        
        // ç•¶é€²éšé¸é …è®ŠåŒ–æ™‚ï¼Œé‡æ–°è¨ˆç®—
        considerWeekCheckbox.addEventListener('change', calculateUpgradeNeeds);
        keepThreeBattlesCheckbox.addEventListener('change', calculateUpgradeNeeds);
        includeSundayBonusCheckbox.addEventListener('change', calculateUpgradeNeeds);
        sundayRankSelect.addEventListener('change', calculateUpgradeNeeds);
        
        // åˆå§‹è¨­å®š
        initLevelSelects();
        initMonsterSelect();
        startCountdown();
        calculateUpgradeNeeds();
        
        // æ›´æ–°åŒ—äº¬æ™‚é–“é¡¯ç¤º
        updateBeijingTime();
        setInterval(updateBeijingTime, 1000);
    </script>
</body>
</html>
